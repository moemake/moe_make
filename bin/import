#!/usr/bin/env node
var config = require('../config');
var fs = require('fs');
var db = require('monk')(config().mongoUrl);
var moes = db.get('moes');
var category = db.get('category');
var session = db.get('session');

var csvPaths = [
  'data/job1.csv',
  'data/job2.csv',
  'data/no_human.csv',
  'data/attr.csv',
  'data/charas.csv',
  'data/tone.csv',
  'data/hair.csv',
  'data/body.csv',
  'data/parts.csv',
  'data/eyes.csv',
  'data/looks.csv',
  'data/cloth.csv',
  'data/option.csv',
];

var categoryId = 1;
var entryId = 1;
csvPaths.forEach(function(path) {
  console.log(path);
  console.log(categoryId);
  var data = "" + fs.readFileSync(path);
  var array = data.split("\n");
  var categoryName = array.shift();
  category.insert({
    categoryId: categoryId,
    categoryName: categoryName,
    subCategoryCount: array.length,
  });
  array.forEach(function(entry) {
    if (entry === '') return;
    moes.insert({
      categoryId: categoryId,
      categoryName: categoryName,
      entryId: entryId,
      entry: entry,
    });
    entryId++;
  });
  categoryId++;
});

db.close();
